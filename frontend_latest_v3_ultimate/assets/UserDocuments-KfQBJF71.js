import{c as U,r as d,d as C,j as e,e as E,X as I,g as y,F as w,B as N}from"./index-B5frEt5u.js";import{S as $}from"./save-DWpH1zYC.js";import{P as M,E as T}from"./pencil-line-CoTPCWqI.js";import{I as P}from"./image-DVAsidwc.js";import{A as v}from"./award-IRQuEGaB.js";import{L as S}from"./link-Ga9T1P8b.js";const G=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],F=U("upload",G),h=({label:a,id:i,onChange:g,required:f=!1,icon:s,description:_,uploadedFile:r,isEditing:b})=>{const[x,p]=d.useState(null);d.useEffect(()=>{if(r?.file){const c=URL.createObjectURL(r.file);return p(c),()=>URL.revokeObjectURL(c)}else if(r?.isExisting&&r?.url){const c=r.url.startsWith("http")?r.url:`${window.API_BASE_URL}${r.url}`;typeof r.url=="string"&&r.url.match(/\.(jpg|jpeg|png|webp|gif|svg)$/i)?p(c):p(null)}else p(null)},[r]);const n=`${window.API_BASE_URL}`;return e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden transition-all hover:shadow-md",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg text-gray-500",children:s&&e.jsx(s,{className:"h-5 w-5"})}),e.jsx("h3",{className:"text-sm font-bold text-gray-900",children:a})]}),x?e.jsxs("div",{className:"relative aspect-[4/3] rounded-xl overflow-hidden mb-4 bg-gray-100 border border-gray-100 group",children:[e.jsx("img",{src:x,alt:a,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-white rounded-full text-gray-900 shadow-lg",children:e.jsx(T,{className:"w-5 h-5"})})})]}):r?.isExisting?e.jsxs("div",{className:"aspect-[4/3] rounded-xl bg-blue-50 border border-blue-100 flex flex-col items-center justify-center mb-4 gap-2",children:[e.jsx(w,{className:"w-10 h-10 text-blue-400"}),e.jsx("span",{className:"text-xs font-bold text-blue-600",children:"DOKUMEN TERSEDIA (PDF)"}),e.jsx("a",{href:`${n}${r.url}`,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-blue-500 underline",children:"Lihat Dokumen"})]}):e.jsxs("div",{className:"aspect-[4/3] rounded-xl bg-gray-50 border border-dashed border-gray-200 flex flex-col items-center justify-center mb-4 gap-2 text-gray-400",children:[e.jsx(F,{className:"w-8 h-8 opacity-20"}),e.jsx("span",{className:"text-[10px] font-medium tracking-wider",children:"BELUM ADA DOKUMEN"})]}),b?e.jsxs("div",{className:"mt-2 group",children:[e.jsxs("label",{htmlFor:i,className:"w-full h-12 flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-50 border-2 border-dashed border-blue-200 rounded-xl text-xs font-bold text-blue-700 hover:bg-blue-100 hover:border-blue-300 transition-all cursor-pointer select-none active:scale-[0.98]",children:[e.jsx(F,{className:"w-4 h-4"}),r?.file?"Ganti Berkas":"Pilih Berkas",e.jsx("input",{id:i,name:i,type:"file",className:"sr-only",onChange:g,onClick:c=>{c.target.value=null},accept:i==="cv"?".pdf":i==="sertifikat"||i==="paklaring"||i==="portofolioFile"?".pdf,image/*":"image/*"})]}),r?.file&&e.jsxs("p",{className:"mt-2 text-[10px] text-blue-600 font-bold italic truncate px-1",children:["Akan diunggah: ",r.file.name]})]}):e.jsx("div",{className:"mt-2",children:r?.isExisting?e.jsxs("div",{className:"flex items-center justify-center gap-1.5 py-2 px-3 bg-green-50 rounded-lg border border-green-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-bold text-green-700 uppercase tracking-tight",children:"Terverifikasi"})]}):f?e.jsxs("div",{className:"flex items-center justify-center gap-1.5 py-2 px-3 bg-rose-50 rounded-lg border border-rose-100",children:[e.jsx(y,{className:"w-3.5 h-3.5 text-rose-500"}),e.jsx("span",{className:"text-[10px] font-bold text-rose-700 uppercase tracking-tight",children:"Wajib Diisi"})]}):null})]})})},V=()=>{const[a,i]=d.useState({cv:null,pasFoto:null,portofolioFile:null,ktp:null,ijazah:null,sertifikat:null,paklaring:null}),[g,f]=d.useState(""),[s,_]=d.useState({}),[r,b]=d.useState(!0),[x,p]=d.useState(!1),[n,c]=d.useState(!1),{showNotification:m}=C();d.useEffect(()=>{k()},[]);const k=async()=>{b(!0);try{const t=await(await fetch(`${window.API_BASE_URL}/api/user/documents`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();t.success&&(_(t.data||{}),t.data?.portfolio_link&&f(t.data.portfolio_link))}catch(l){console.error("Error fetching documents:",l)}finally{b(!1)}},u=l=>t=>{const o=t.target.files?.[0];if(!o)return;const j=5*1024*1024;if(o.size>j){m("error","Ukuran File Terlalu Besar",`Maksimal ukuran file adalah 5MB. File "${o.name}" berukuran ${(o.size/(1024*1024)).toFixed(2)}MB.`),t.target.value="";return}if(l==="cv"&&o.type!=="application/pdf"){m("error","Format Tidak Sesuai","Curriculum Vitae (CV) harus dalam format PDF."),t.target.value="";return}if((l==="pasFoto"||l==="ktp"||l==="ijazah")&&!o.type.startsWith("image/")&&o.type!=="application/pdf"){m("error","Format Tidak Sesuai","Dokumen harus dalam format gambar (JPG, PNG, WEBP) atau PDF."),t.target.value="";return}i(z=>({...z,[l]:o}))},D=async l=>{l.preventDefault(),p(!0);const t=new FormData;a.cv&&t.append("cv",a.cv),a.pasFoto&&t.append("pasFoto",a.pasFoto),a.portofolioFile&&t.append("portofolioFile",a.portofolioFile),g&&t.append("portfolioLink",g),a.ktp&&t.append("ktp",a.ktp),a.ijazah&&t.append("ijazah",a.ijazah),a.sertifikat&&t.append("sertifikat",a.sertifikat),a.paklaring&&t.append("paklaring",a.paklaring);try{const j=await(await fetch(`${window.API_BASE_URL}/api/user/documents`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:t})).json();j.success?(m("success","Berhasil!","Dokumen telah disimpan."),c(!1),i({cv:null,pasFoto:null,portofolioFile:null,ktp:null,ijazah:null,sertifikat:null,paklaring:null}),k()):m("error","Gagal!",j.message||"Gagal menyimpan dokumen")}catch(o){console.error("Error submitting documents:",o),m("error","Kesalahan","Terjadi kesalahan koneksi.")}finally{p(!1)}},A=()=>{c(!1),i({cv:null,pasFoto:null,portofolioFile:null,ktp:null,ijazah:null,sertifikat:null,paklaring:null}),k()},B=(a.cv||s.cv_url)&&(a.pasFoto||s.photo_url)&&(a.ktp||s.ktp_url)&&(a.ijazah||s.ijazah_url);if(r)return e.jsxs("div",{className:"p-6 flex flex-col items-center justify-center min-h-[400px]",children:[e.jsx(E,{className:"w-10 h-10 text-blue-500 animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium tracking-wide",children:"Menyelaraskan dokumen..."})]});const L=`${window.API_BASE_URL}`;return e.jsxs("div",{className:"pb-12 bg-transparent",children:[e.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-4 bg-transparent border-b border-gray-200/50 mb-8 transition-all",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 tracking-tight",children:"Berkas Karir"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 font-medium",children:"Kelola dokumen persyaratan lamaran Anda di sini."})]}),e.jsx("div",{className:"flex gap-3",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:A,disabled:x,className:"flex items-center gap-2 px-4 py-2 sm:px-5 sm:py-2.5 bg-white border border-gray-200 rounded-xl text-sm font-bold text-gray-600 hover:bg-gray-50 transition-all shadow-sm disabled:opacity-50",children:[e.jsx(I,{className:"w-4 h-4"})," Batal"]}),e.jsxs("button",{onClick:D,disabled:x,className:"flex items-center gap-2 px-5 py-2 sm:px-6 sm:py-2.5 bg-blue-600 text-white rounded-xl text-sm font-extrabold hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 disabled:opacity-50",children:[x?e.jsx(E,{className:"w-4 h-4 animate-spin"}):e.jsx($,{className:"w-4 h-4"}),x?"Menyimpan...":"Simpan Perubahan"]})]}):e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-5 py-2 sm:px-6 sm:py-2.5 bg-white border-2 border-blue-600 text-blue-600 rounded-xl text-sm font-extrabold hover:bg-blue-50 transition-all",children:[e.jsx(M,{className:"w-4 h-4"})," Edit Dokumen"]})})]})}),!B&&!n&&e.jsxs("div",{className:"bg-rose-50 border border-rose-100 rounded-2xl p-4 mb-8 flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-rose-100 rounded-xl text-rose-600 flex-shrink-0",children:e.jsx(y,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-rose-900",children:"Dokumen Belum Lengkap"}),e.jsxs("p",{className:"text-sm text-rose-700 leading-relaxed",children:["Silakan klik tombol ",e.jsx("b",{children:"Ubah Dokumen"})," di atas dan unggah CV, Pas Foto, KTP, serta Ijazah agar Anda dapat mulai melamar posisi yang tersedia."]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-2 border-b border-gray-200",children:[e.jsx("div",{className:"p-2 bg-rose-50 rounded-lg",children:e.jsx(y,{className:"w-5 h-5 text-rose-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 uppercase tracking-tight",children:"Dokumen Wajib"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Harus dilengkapi sebelum melamar pekerjaan."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(h,{label:"Curriculum Vitae (CV)",id:"cv",icon:w,isEditing:n,required:!0,onChange:u("cv"),uploadedFile:a.cv?{file:a.cv}:{isExisting:!!s?.cv_url,url:s?.cv_url},description:"Format PDF, Max 2MB"}),e.jsx(h,{label:"Pas Foto Terbaru",id:"pasFoto",icon:P,isEditing:n,required:!0,onChange:u("pasFoto"),uploadedFile:a.pasFoto?{file:a.pasFoto}:{isExisting:!!s?.photo_url,url:s?.photo_url},description:"Format JPG/PNG, Wajah terlihat jelas"}),e.jsx(h,{label:"Foto KTP",id:"ktp",icon:P,isEditing:n,required:!0,onChange:u("ktp"),uploadedFile:a.ktp?{file:a.ktp}:{isExisting:!!s?.ktp_url,url:s?.ktp_url},description:"Format JPG/PNG, NIK terbaca"}),e.jsx(h,{label:"Ijazah",id:"ijazah",icon:v,isEditing:n,required:!0,onChange:u("ijazah"),uploadedFile:a.ijazah?{file:a.ijazah}:{isExisting:!!s?.ijazah_url,url:s?.ijazah_url},description:"Format PDF/JPG/PNG, Max 5MB"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-2 border-b border-gray-200",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(v,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 uppercase tracking-tight",children:"Dokumen Opsional"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Dapat ditambahkan untuk memperkuat profil Anda."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 min-h-[300px]",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden transition-all hover:shadow-md h-full flex flex-col",children:e.jsxs("div",{className:"p-5 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg text-gray-500",children:e.jsx(N,{className:"h-5 w-5"})}),e.jsx("h3",{className:"text-sm font-bold text-gray-900",children:"Portofolio"})]}),e.jsx("div",{className:"space-y-4",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 border-2 border-dashed border-blue-200 rounded-xl p-4 text-center group hover:bg-blue-100 hover:border-blue-300 transition-all cursor-pointer relative",children:[e.jsxs("label",{htmlFor:"portofolioFile",className:"cursor-pointer block",children:[e.jsx(F,{className:"w-8 h-8 text-blue-400 mx-auto mb-2 opacity-60 group-hover:opacity-100"}),e.jsx("p",{className:"text-[10px] font-bold text-blue-700 uppercase",children:"Upload Berkas (PDF/LinkGambar)"}),e.jsx("input",{id:"portofolioFile",type:"file",className:"sr-only",onChange:u("portofolioFile"),onClick:l=>{l.target.value=null},accept:".pdf,image/*"})]}),a.portofolioFile&&e.jsxs("p",{className:"mt-2 text-[10px] text-blue-600 font-bold truncate px-1",children:["Siap: ",a.portofolioFile.name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1.5 block px-1",children:"Atau Tautan Eksternal"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsx("input",{type:"url",placeholder:"https://behance.net/username",className:"w-full pl-9 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs focus:ring-2 focus:ring-blue-500 outline-none transition-all",value:g,onChange:l=>f(l.target.value)})]})]})]}):e.jsx("div",{className:"bg-gray-50/50 rounded-xl p-4 border border-gray-100 text-center min-h-[120px] flex flex-col items-center justify-center gap-3",children:s.portfolio_url||s.portfolio_link?e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[s.portfolio_url&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx(w,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}),e.jsx("span",{className:"text-[10px] font-bold text-gray-700 truncate",children:"Berkas Terunggah"})]}),e.jsx("a",{href:`${L}${s.portfolio_url}`,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-blue-600 font-extrabold hover:underline whitespace-nowrap",children:"LIHAT PDF"})]}),s.portfolio_link&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx(S,{className:"w-4 h-4 text-indigo-500 flex-shrink-0"}),e.jsx("span",{className:"text-[10px] font-bold text-gray-700 truncate",children:s.portfolio_link.replace(/^https?:\/\//,"")})]}),e.jsx("a",{href:s.portfolio_link.startsWith("http")?s.portfolio_link:`https://${s.portfolio_link}`,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-indigo-600 font-extrabold hover:underline whitespace-nowrap",children:"BUKA LINK"})]})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2 text-gray-300",children:[e.jsx(N,{className:"w-8 h-8 opacity-20"}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Belum Ada Data"})]})})})]})}),e.jsx(h,{label:"Sertifikat Pendukung",id:"sertifikat",icon:v,isEditing:n,required:!1,onChange:u("sertifikat"),uploadedFile:a.sertifikat?{file:a.sertifikat}:{isExisting:!!s?.other_url,url:s?.other_url},description:"Sertifikat keahlian / pelatihan"}),e.jsx(h,{label:"Surat Keterangan Kerja (Paklaring)",id:"paklaring",icon:N,isEditing:n,required:!1,onChange:u("paklaring"),uploadedFile:a.paklaring?{file:a.paklaring}:{isExisting:!!s?.paklaring_url,url:s?.paklaring_url},description:"Jika memiliki pengalaman kerja"})]})]})]})};export{V as default};
