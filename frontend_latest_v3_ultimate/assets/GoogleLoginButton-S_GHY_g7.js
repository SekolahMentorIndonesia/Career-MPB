import{b as u,r as s,A as h,d as f,j as a,e as m}from"./index-B5frEt5u.js";const p=({from:t})=>{const n=u(),{setAuth:r}=s.useContext(h),{showNotification:o}=f(),[c,i]=s.useState(!1);s.useEffect(()=>{window.google&&(window.google.accounts.id.initialize({client_id:"759262548822-vqokcr588k172e25gclvdr5j131uoeeo.apps.googleusercontent.com",callback:d,auto_select:!1}),window.google.accounts.id.renderButton(document.getElementById("googleSignInButton"),{theme:"outline",size:"large",width:"100%",text:"continue_with",shape:"rectangular"}))},[]);const d=async g=>{i(!0);try{const e=await(await fetch(`${window.API_BASE_URL}/api/auth/google`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:g.credential})})).json();e.success?(r(e.data.token,e.data.user),o("success","Login Berhasil!",`Selamat datang, ${e.data.user.name}!`),e.data.user.role?.toUpperCase()==="ADMIN"?n("/dashboard/admin"):n(t&&t!=="/"?t:"/dashboard/user")):o("error","Login Gagal",e.message||"Terjadi kesalahan saat login dengan Google")}catch(l){console.error("Google login error:",l),o("error","Kesalahan","Terjadi kesalahan koneksi. Silakan coba lagi.")}finally{i(!1)}};return a.jsxs("div",{className:"relative w-full max-w-[calc(100vw-3rem)] mx-auto flex justify-center overflow-hidden",children:[c&&a.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center rounded-lg z-10",children:a.jsx(m,{className:"w-6 h-6 text-blue-600 animate-spin"})}),a.jsx("div",{id:"googleSignInButton",className:"w-full min-h-[44px] flex justify-center"})]})};export{p as G};
