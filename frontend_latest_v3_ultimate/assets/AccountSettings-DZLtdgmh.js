import{c as E,a as U,r as a,j as e,l as $,X as F,h as T}from"./index-B5frEt5u.js";import{C as y}from"./camera-oEDDWjEe.js";import{C as L}from"./circle-check-DJyuKXbo.js";const M=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],w=E("shield-check",M),D=()=>{const{user:i,token:c,updateUser:N}=U(),[k,d]=a.useState(!1),[x,z]=a.useState(""),[m,u]=a.useState(["","","","","",""]),[v,h]=a.useState(!1),[l,o]=a.useState(0),[p,S]=a.useState({email:i?.email||"",isEmailVerified:!0}),[f,A]=a.useState(i?.photo?`${window.API_BASE_URL}${i.photo}`:null),b=`${window.API_BASE_URL}/api`,I=async t=>{const s=t.target.files[0];if(!s)return;h(!0);const r=new FormData;r.append("photo",s);try{if((await(await fetch(`${b}/user/upload-photo`,{method:"POST",headers:{Authorization:`Bearer ${c}`},body:r})).json()).status==="success"){A(URL.createObjectURL(s));const j=await(await fetch(`${b}/user/profile`,{headers:{Authorization:`Bearer ${c}`}})).json();j.status==="success"&&N(j.data)}}catch(n){console.error("Photo upload failed:",n)}finally{h(!1)}};a.useEffect(()=>{let t;return l>0&&(t=setInterval(()=>{o(s=>s-1)},1e3)),()=>clearInterval(t)},[l]);const P=async(t=!0)=>{!t&&l>0||t&&o(60)},C=(t,s)=>{if(s.length>1)return;const r=[...m];if(r[t]=s,u(r),s&&t<5){const n=document.getElementById(`otp-${t+1}`);n&&n.focus()}},O=()=>{x==="email"&&S(t=>({...t,isEmailVerified:!0})),d(!1),u(["","","","","",""]),o(0)},g=({title:t,icon:s})=>e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-2 border-b border-gray-100",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(s,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 uppercase tracking-tight",children:t})]}),R=({label:t,required:s})=>e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:[t," ",s&&e.jsx("span",{className:"text-red-500",children:"*"})]});return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 md:p-8 space-y-8 animate-in fade-in duration-500",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-2",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Pengaturan Akun"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Kelola keamanan akun dan unggah foto profil Anda di sini."})]})}),e.jsxs("section",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden p-6 md:p-8",children:[e.jsx(g,{title:"Foto Profil",icon:y}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[e.jsxs("div",{className:"group relative w-40 h-40 rounded-full bg-blue-50 border-4 border-white shadow-xl flex flex-col items-center justify-center cursor-pointer hover:bg-blue-100 transition-all overflow-hidden",children:[f?e.jsx("img",{src:f,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(y,{className:"w-10 h-10 text-blue-300"}),e.jsx("input",{type:"file",accept:"image/*",onChange:I,className:"absolute inset-0 opacity-0 cursor-pointer z-10",disabled:v}),e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("span",{className:"text-white text-xs font-bold uppercase tracking-wider",children:"Ganti Foto"})})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left space-y-2",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Unggah Foto Baru"}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:"Foto ini akan ditampilkan pada profil dan kartu pelamar Anda. Pastikan foto terlihat jelas (wajah menghadap ke depan)."}),e.jsx("p",{className:"text-[10px] text-blue-600 font-bold uppercase tracking-widest bg-blue-50 px-3 py-1 inline-block rounded-full",children:"Format: JPG, PNG â€¢ Max: 2MB"})]})]})]}),e.jsx("section",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsx(g,{title:"Keamanan & Akses",icon:w}),e.jsx("div",{className:"space-y-8",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{label:"Email Terhubung"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 p-4 bg-gray-50 border border-gray-200 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg border border-gray-100 shadow-sm text-blue-600 flex-shrink-0",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm font-bold text-gray-700 truncate",children:p.email})]}),e.jsxs("div",{className:"flex items-center self-start sm:self-auto gap-1.5 px-3 py-1 bg-green-50 border border-green-100 rounded-full flex-shrink-0",children:[e.jsx(L,{className:"w-3.5 h-3.5 text-green-600"}),e.jsx("span",{className:"text-[10px] font-black text-green-700 uppercase tracking-tight",children:"Terverifikasi"})]})]})]})})})]})}),k&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-gray-900/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-3xl shadow-2xl p-8 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-50 rounded-2xl",children:e.jsx(w,{className:"w-8 h-8 text-blue-600"})}),e.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(F,{className:"w-6 h-6 text-gray-400"})})]}),e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tight",children:"Verifikasi OTP"}),e.jsxs("p",{className:"text-gray-500 mt-2 text-sm leading-relaxed",children:["Masukkan 6 digit kode yang kami kirimkan ke",e.jsxs("span",{className:"font-bold text-gray-800",children:[" ",x==="email"?p.email:i?.phone||"08123456789"]})]}),e.jsx("div",{className:"flex justify-between gap-2 mt-8",children:m.map((t,s)=>e.jsx("input",{id:`otp-${s}`,type:"text",maxLength:1,value:t,onChange:r=>C(s,r.target.value),className:"w-full h-14 text-center text-xl font-black bg-gray-50 border-2 border-gray-100 rounded-2xl focus:border-blue-500 focus:ring-4 focus:ring-blue-500/10 outline-none transition-all"},s))}),e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsx("button",{onClick:O,className:"w-full py-4 bg-blue-600 text-white font-black rounded-2xl shadow-xl shadow-blue-500/20 hover:bg-blue-700 hover:-translate-y-1 active:translate-y-0 transition-all",children:"KONFIRMASI VERIFIKASI"}),e.jsxs("p",{className:"text-center text-sm text-gray-500 font-medium",children:["Tidak menerima kode?"," ",e.jsx("button",{onClick:()=>P(!0),disabled:l>0,className:T("font-bold hover:underline",l>0?"text-gray-400 cursor-not-allowed no-underline":"text-blue-600"),children:l>0?`Kirim Ulang (${l}s)`:"Kirim Ulang"})]})]})]})})]})};export{D as default};
