import{c as M,a as T,r as o,j as e,e as v,N as G,l as I,P as L}from"./index-B5frEt5u.js";import{C as R}from"./ConfirmationModal-2kZPKyqO.js";import{U as k}from"./user-BRxEefNs.js";import{C as z}from"./camera-oEDDWjEe.js";import{T as H}from"./trash-2-PlqAtpsV.js";import{S as O}from"./save-DWpH1zYC.js";import"./open-closed-BNHp7105.js";const _=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],P=M("lock",_),X=()=>{const{updateUser:h}=T(),[a,c]=o.useState({name:"",email:"",phone:"",photo:""}),[A,S]=o.useState(!0),[u,m]=o.useState(!1),[d,j]=o.useState(null),[w,x]=o.useState(null),[f,g]=o.useState(null),[C,b]=o.useState(!1),i=`${window.API_BASE_URL}`;o.useEffect(()=>{E()},[]);const E=async()=>{try{const t=await(await fetch(`${i}/api/user/profile`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();t.success&&(c({name:t.data.name||"",email:t.data.email||"",phone:t.data.phone||"",photo:t.data.photo||""}),h(t.data))}catch(s){console.error("Error fetching profile:",s),r("error","Gagal memuat profil")}finally{S(!1)}},r=(s,t,l)=>{j({type:s,title:t,message:l})},B=s=>{const{name:t,value:l}=s.target;c(n=>({...n,[t]:l}))},D=s=>{const t=s.target.files[0];if(t){if(t.size>2*1024*1024){r("error","Ukuran File Terlalu Besar","Maksimal ukuran foto adalah 2MB.");return}x(t),g(URL.createObjectURL(t))}},U=async s=>{s.preventDefault(),m(!0);try{let t=a.photo;if(w){const p=new FormData;p.append("photo",w);const y=await(await fetch(`${i}/api/user/upload-photo`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},body:p})).json();if(y.success)t=y.data.photo_url;else throw new Error(y.message||"Gagal mengunggah foto")}const n=await(await fetch(`${i}/api/user/profile`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({name:a.name,email:a.email,phone:a.phone,photo:t})})).json();if(n.success){r("success","Berhasil","Profil Anda telah diperbarui.");const p={name:a.name,email:a.email,phone:a.phone,photo:t};c(N=>({...N,photo:t})),x(null),g(null),h(p)}else throw new Error(n.message||"Gagal memperbarui profil")}catch(t){r("error","Gagal",t.message)}finally{m(!1)}},$=()=>{b(!0)},F=async()=>{b(!1),m(!0);try{const t=await(await fetch(`${i}/api/user/upload-photo`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(t.success){r("success","Berhasil","Foto profil telah dihapus.");const l={...a,photo:null};c(n=>({...n,photo:null})),x(null),g(null),h(l)}else throw new Error(t.message||"Gagal menghapus foto")}catch(s){r("error","Gagal",s.message)}finally{m(!1)}};return A?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(v,{className:"w-10 h-10 animate-spin text-blue-600"})}):e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-4xl mx-auto",children:[d&&e.jsx(G,{type:d.type,title:d.title,message:d.message,onClose:()=>j(null)}),e.jsx(R,{isOpen:C,title:"Hapus Foto Profil",message:"Apakah Anda yakin ingin menghapus foto profil Anda? Tindakan ini tidak dapat dibatalkan.",onConfirm:F,onCancel:()=>b(!1),confirmText:"Ya, Hapus",cancelText:"Batal",type:"danger"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-gray-900 tracking-tight",children:"Profil Admin"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 font-medium",children:"Kelola informasi dasar akun administrator Anda."})]}),e.jsx("div",{className:"bg-white rounded-3xl shadow-xl shadow-gray-200/50 border border-gray-100 overflow-hidden",children:e.jsxs("form",{onSubmit:U,className:"p-6 sm:p-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 mb-10 pb-10 border-b border-gray-100",children:[e.jsx("div",{className:"relative group",children:e.jsxs("div",{className:"w-32 h-32 rounded-3xl overflow-hidden ring-4 ring-blue-50 bg-gray-50 flex items-center justify-center shadow-inner",children:[f||a.photo?e.jsx("img",{src:f||(a.photo?`${i}${a.photo}`:null),alt:"Profile",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):e.jsx(k,{className:"w-12 h-12 text-gray-300"}),e.jsxs("label",{className:"absolute inset-0 bg-blue-600/60 flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 cursor-pointer backdrop-blur-[2px]",children:[e.jsx(z,{className:"w-8 h-8 text-white mb-1"}),e.jsx("span",{className:"text-[10px] text-white font-black uppercase tracking-widest",children:"Ubah Foto"}),e.jsx("input",{type:"file",className:"sr-only",onChange:D,accept:"image/*"})]})]})}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Pas Foto Admin"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium max-w-xs mb-2",children:"Gunakan foto formal profesional. Format JPG/PNG, maks. 2MB."}),(a.photo||f)&&e.jsxs("button",{type:"button",onClick:$,className:"text-xs text-red-500 hover:text-red-700 font-bold flex items-center gap-1 transition-colors px-2 py-1 rounded hover:bg-red-50",children:[e.jsx(H,{className:"w-3.5 h-3.5"})," Hapus Foto"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest ml-1",children:"Nama Lengkap"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400 group-focus-within:text-blue-500 transition-colors",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx("input",{type:"text",name:"name",value:a.name,onChange:B,placeholder:"Masukkan nama lengkap",className:"w-full pl-11 pr-4 py-3 bg-gray-50 border-2 border-transparent focus:border-blue-500 focus:bg-white rounded-2xl text-sm font-bold text-gray-900 outline-none transition-all",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest ml-1",children:"Alamat Email"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400",children:e.jsx(I,{className:"w-4 h-4"})}),e.jsx("input",{type:"email",name:"email",value:a.email,readOnly:!0,disabled:!0,className:"w-full pl-11 pr-4 py-3 bg-gray-200 border-2 border-transparent rounded-2xl text-sm font-bold text-gray-500 outline-none cursor-not-allowed select-none"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none text-gray-400",children:e.jsx(P,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-[10px] text-red-400 font-medium ml-1",children:"*Hanya dapat diubah melalui Database"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-black text-gray-400 uppercase tracking-widest ml-1",children:"Nomor WhatsApp"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-400",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx("input",{type:"text",name:"phone",value:a.phone,readOnly:!0,disabled:!0,className:"w-full pl-11 pr-4 py-3 bg-gray-200 border-2 border-transparent rounded-2xl text-sm font-bold text-gray-500 outline-none cursor-not-allowed select-none"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none text-gray-400",children:e.jsx(P,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-[10px] text-red-400 font-medium ml-1",children:"*Hanya dapat diubah melalui Database"})]})]}),e.jsx("div",{className:"mt-12 pt-8 border-t border-gray-50 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:u,className:"flex items-center gap-3 px-8 py-4 bg-blue-600 text-white rounded-2xl text-sm font-black hover:bg-blue-700 transition-all shadow-xl shadow-blue-200 disabled:opacity-50 active:scale-95",children:[u?e.jsx(v,{className:"w-5 h-5 animate-spin"}):e.jsx(O,{className:"w-5 h-5"}),u?"MENYIMPAN...":"SIMPAN PERUBAHAN"]})})]})})]})};export{X as default};
